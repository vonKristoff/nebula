!function(a){a.fn.nebula=function(c){var d=a(this),e=new b(d,c);return window.onresize=function(){e.resize()},this.el};var b=function(b,c){this.config={mixture:.85,smoke:.875,color1:[227,192,128],color2:[80,20,10],density:20};var d=(1-this.config.smoke)/10;this.config.color1[3]=this.config.mixture,this.config.color2[3]=d,a.extend(this.config,c),this.el=b,this.w=window.innerWidth,this.h=window.innerHeight,this.ratio=this.ratiolise(),this.init()};b.prototype.init=function(){var a=this.buildLayers();this.el.css({"background-image":a})},b.prototype.buildLayers=function(){for(var a=this.config,b=a.density,c=[],d=0;b>d;d++){var e=~~(20*Math.random())+30,f={x:~~(100*Math.random()),y:~~(100*Math.random()),c1:0==d%2?a.color1:a.color1,c2:a.color2,dx:e,dy:~~(e*(1+(1-this.ratio)))};f.c1=this.colorMix(f.c1),f.c2=this.colorMix(f.c2),c[d]=this.gradientString(f)}return c.join()},b.prototype.colorMix=function(a){var b=a[3],c=this.hsl(a),d=c[0],e=c[1],f=c[2],g=~~(20*Math.random())+d,h=~~(Math.random()*e/2)+e/2,i=~~(Math.random()*f/2)+f/2,j=this.rgb([g,h,i]);return j[3]=b,j},b.prototype.gradientString=function(a){var b=[a.c1],c=[a.c2],d="-webkit-radial-gradient( ";return d+=a.x+"% ",d+=a.y+"%,",d+=a.dx+"% ",d+=a.dy+"%,",d+="rgba("+b.join()+") 10%,",d+="rgba("+c.join()+") 70%",d+=" )"},b.prototype.ratiolise=function(){var a=this.w<this.h?this.w/this.h:this.h/this.w;return a},b.prototype.resize=function(){this.w=window.innerWidth,this.h=window.innerHeight,this.ratio=this.ratiolise()},b.prototype.rgbise=function(a){var b=a[0],c=a[1],d=a[2],e="rgb(";return e+=b+",",e+=c+",",e+=d+")"},b.prototype.rgbaise=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f="rgba(";return f+=b+",",f+=c+",",f+=d+",",f+=e+")"},b.prototype.hsl=function(a){var b=a[0]/255,c=a[1]/255,d=a[2]/255,e=Math.max(b,c,d),f=Math.min(b,c,d),g=(e+f)/2,h=0,i=0;e!=f&&(h=.5>g?(e-f)/(e+f):(e-f)/(2-e-f),i=b==e?(c-d)/(e-f):c==e?2+(d-b)/(e-f):4+(b-c)/(e-f)),g=100*g,h=100*h,i=60*i,0>i&&(i+=360);var j=[i,h,g];return j},b.prototype.rgb=function(a){var b,c,d,e,f,g,h=a[0],i=a[1],j=a[2];return i/=100,j/=100,0==i?e=f=g=255*j:(c=.5>=j?j*(i+1):j+i-j*i,b=2*j-c,d=h/360,e=this.hue2rgb(b,c,d+1/3),f=this.hue2rgb(b,c,d),g=this.hue2rgb(b,c,d-1/3)),[Math.round(e),Math.round(f),Math.round(g)]},b.prototype.hue2rgb=function(a,b,c){var d;return 0>c?c+=1:c>1&&(c-=1),d=1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a,255*d}}(jQuery);